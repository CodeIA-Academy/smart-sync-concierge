{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Appointment",
  "description": "Esquema de una cita en Smart-Sync Concierge",
  "type": "object",
  "required": ["id", "status", "created_at", "prompt_original", "fecha", "hora_inicio", "hora_fin"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^apt_[0-9]{8}_[a-z0-9]+$",
      "description": "ID único de la cita"
    },
    "status": {
      "type": "string",
      "enum": ["pending", "confirmed", "cancelled", "completed"],
      "description": "Estado de la cita"
    },
    "created_at": {
      "type": "string",
      "format": "date-time",
      "description": "Fecha de creación (ISO 8601)"
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "Fecha de última actualización"
    },
    "prompt_original": {
      "type": "string",
      "maxLength": 500,
      "description": "Prompt original del usuario"
    },
    "fecha": {
      "type": "string",
      "format": "date",
      "pattern": "^[0-9]{4}-[0-9]{2}-[0-9]{2}$",
      "description": "Fecha de la cita (YYYY-MM-DD)"
    },
    "hora_inicio": {
      "type": "string",
      "pattern": "^[0-9]{2}:[0-9]{2}$",
      "description": "Hora de inicio (HH:MM)"
    },
    "hora_fin": {
      "type": "string",
      "pattern": "^[0-9]{2}:[0-9]{2}$",
      "description": "Hora de fin (HH:MM)"
    },
    "duracion_minutos": {
      "type": "integer",
      "minimum": 15,
      "maximum": 480,
      "default": 60,
      "description": "Duración en minutos"
    },
    "zona_horaria": {
      "type": "string",
      "format": "timezone",
      "default": "America/Mexico_City",
      "description": "Zona horaria (IANA)"
    },
    "tipo": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "ID del tipo de servicio"
        },
        "nombre": {
          "type": "string",
          "description": "Nombre del servicio"
        },
        "categoria": {
          "type": "string",
          "enum": ["medica", "odontologia", "otra"],
          "description": "Categoría del servicio"
        }
      },
      "required": ["id", "nombre"]
    },
    "participantes": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string"
          },
          "nombre": {
            "type": "string"
          },
          "rol": {
            "type": "string",
            "enum": ["prestador", "cliente"]
          },
          "contacto": {
            "type": "object",
            "properties": {
              "email": {
                "type": "string",
                "format": "email"
              },
              "telefono": {
                "type": "string"
              }
            }
          }
        },
        "required": ["id", "nombre", "rol"]
      }
    },
    "ubicacion": {
      "type": "object",
      "properties": {
        "tipo": {
          "type": "string",
          "enum": ["presencial", "virtual", "domicilio"]
        },
        "direccion": {
          "type": "string"
        },
        "coordenadas": {
          "type": "object",
          "properties": {
            "lat": {
              "type": "number",
              "minimum": -90,
              "maximum": 90
            },
            "lng": {
              "type": "number",
              "minimum": -180,
              "maximum": 180
            }
          }
        }
      }
    },
    "notas": {
      "type": "object",
      "properties": {
        "cliente": {
          "type": "string"
        },
        "interna": {
          "type": "string"
        },
        "ia_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1
        }
      }
    },
    "recordatorios": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "tipo": {
            "type": "string",
            "enum": ["email", "sms", "push"]
          },
          "enviado": {
            "type": "boolean"
          },
          "programado_para": {
            "type": "string",
            "format": "date-time"
          }
        }
      }
    },
    "metadata_validacion": {
      "type": "object",
      "properties": {
        "contacto_validado": {
          "type": "boolean"
        },
        "servicio_validado": {
          "type": "boolean"
        },
        "horario_validado": {
          "type": "boolean"
        },
        "conflictos_verificados": {
          "type": "boolean"
        },
        "conflictos_encontrados": {
          "type": "integer"
        }
      }
    }
  }
}
